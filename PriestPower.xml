<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/ ..\FrameXML\UI.xsd">
    <!-- Scripts loaded via TOC -->

    <!-- Single Buff Button (Half Width) -->
    <Button name="PriestPowerSubButtonTemplate" virtual="true">
        <Size>
            <AbsDimension x="24" y="24"/>
        </Size>
        <Layers>
             <Layer level="BACKGROUND">
                <Texture name="$parentBackground">
                     <Color r="0.1" g="0.1" b="0.1" a="0.5"/>
                </Texture>
             </Layer>
            <Layer level="OVERLAY">
                <Texture name="$parentIcon">
                    <Size>
                        <AbsDimension x="20" y="20"/>
                    </Size>
                    <Anchors>
                        <Anchor point="CENTER"/>
                    </Anchors>
                </Texture>
                 <!-- Added Status Text -->
                 <FontString name="$parentText" inherits="GameFontHighlightSmall" text="" justifyH="CENTER">
                     <Anchors>
                        <Anchor point="BOTTOM"><Offset><AbsDimension x="0" y="2"/></Offset></Anchor>
                     </Anchors>
                 </FontString>
            </Layer>
        </Layers>
        <Scripts>
            <OnLoad>this:RegisterForClicks("LeftButtonUp", "RightButtonUp")</OnLoad>
            <OnClick>PriestPowerSubButton_OnClick(this)</OnClick>
            <OnEnter>PriestPowerSubButton_OnEnter(this)</OnEnter>
            <OnLeave>GameTooltip:Hide()</OnLeave>
        </Scripts>
    </Button>

    <!-- Group Container (Holds Fort + Spirit) -->
    <Frame name="PriestPowerGroupTemplate" virtual="true">
        <Size>
            <AbsDimension x="52" y="42"/>
        </Size>
        <Backdrop bgFile="Interface\Tooltips\UI-Tooltip-Background" edgeFile="Interface\Tooltips\UI-Tooltip-Border" tile="true">
            <EdgeSize><AbsValue val="8"/></EdgeSize>
            <TileSize><AbsValue val="8"/></TileSize>
            <BackgroundInsets><AbsInset left="1" right="1" top="1" bottom="1"/></BackgroundInsets>
        </Backdrop>
        <Frames>
            <Button name="$parentFort" inherits="PriestPowerSubButtonTemplate">
                <Anchors>
                    <Anchor point="LEFT"><Offset><AbsDimension x="1" y="0"/></Offset></Anchor>
                </Anchors>
            </Button>
            <Button name="$parentSpirit" inherits="PriestPowerSubButtonTemplate">
                <Anchors>
                    <Anchor point="LEFT" relativeTo="$parentFort" relativePoint="RIGHT">
                        <Offset><AbsDimension x="0" y="0"/></Offset>
                    </Anchor>
                </Anchors>
            </Button>
        </Frames>
    </Frame>
    
    <!-- Champion Container (Holds Proclaim + Grace + Empower) -->
    <Frame name="PriestPowerChampionTemplate" virtual="true">
        <Size>
            <AbsDimension x="80" y="42"/>
        </Size>
        <Backdrop bgFile="Interface\Tooltips\UI-Tooltip-Background" edgeFile="Interface\Tooltips\UI-Tooltip-Border" tile="true">
            <EdgeSize><AbsValue val="8"/></EdgeSize>
            <TileSize><AbsValue val="8"/></TileSize>
            <BackgroundInsets><AbsInset left="1" right="1" top="1" bottom="1"/></BackgroundInsets>
        </Backdrop>
        <Layers>
            <Layer level="OVERLAY">
                <FontString name="$parentName" inherits="GameFontNormalSmall" text="Champ" justifyH="CENTER">
                    <Anchors><Anchor point="TOP"><Offset><AbsDimension x="0" y="8"/></Offset></Anchor></Anchors>
                </FontString>
            </Layer>
        </Layers>
        <Frames>
            <!-- 3 Small Buttons -->
            <Button name="$parentProclaim" inherits="PriestPowerSubButtonTemplate">
                <Anchors>
                    <Anchor point="LEFT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor>
                </Anchors>
                 <Scripts>
                    <OnLoad>this:RegisterForClicks("LeftButtonUp", "RightButtonUp")</OnLoad>
                    <OnClick>PriestPowerChampButton_OnClick(this)</OnClick>
                    <OnEnter>
                        GameTooltip:SetOwner(this, "ANCHOR_RIGHT")
                        GameTooltip:SetText(SPELL_PROCLAIM)
                        GameTooltip:AddLine("Checks for Proclaim Champion or Holy Champion (Rank 3)")
                        GameTooltip:Show()
                    </OnEnter>
                    <OnLeave>GameTooltip:Hide()</OnLeave>
                </Scripts>
            </Button>
            <Button name="$parentGrace" inherits="PriestPowerSubButtonTemplate">
                <Anchors>
                    <Anchor point="LEFT" relativeTo="$parentProclaim" relativePoint="RIGHT">
                        <Offset><AbsDimension x="0" y="0"/></Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>this:RegisterForClicks("LeftButtonUp", "RightButtonUp")</OnLoad>
                    <OnClick>PriestPowerChampButton_OnClick(this)</OnClick>
                    <OnEnter>
                        GameTooltip:SetOwner(this, "ANCHOR_RIGHT")
                        GameTooltip:SetText(SPELL_GRACE)
                        GameTooltip:Show()
                    </OnEnter>
                    <OnLeave>GameTooltip:Hide()</OnLeave>
                </Scripts>
            </Button>
            <Button name="$parentEmpower" inherits="PriestPowerSubButtonTemplate">
                <Anchors>
                    <Anchor point="LEFT" relativeTo="$parentGrace" relativePoint="RIGHT">
                        <Offset><AbsDimension x="0" y="0"/></Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>this:RegisterForClicks("LeftButtonUp", "RightButtonUp")</OnLoad>
                    <OnClick>PriestPowerChampButton_OnClick(this)</OnClick>
                    <OnEnter>
                        GameTooltip:SetOwner(this, "ANCHOR_RIGHT")
                        GameTooltip:SetText(SPELL_EMPOWER)
                        GameTooltip:Show()
                    </OnEnter>
                    <OnLeave>GameTooltip:Hide()</OnLeave>
                </Scripts>
            </Button>
        </Frames>
    </Frame>
    
    <!-- Enlighten Container (Holds Enlighten Button) -->
    <Frame name="PriestPowerEnlightenTemplate" virtual="true">
        <Size>
            <AbsDimension x="40" y="42"/>
        </Size>
        <Backdrop bgFile="Interface\Tooltips\UI-Tooltip-Background" edgeFile="Interface\Tooltips\UI-Tooltip-Border" tile="true">
            <EdgeSize><AbsValue val="8"/></EdgeSize>
            <TileSize><AbsValue val="8"/></TileSize>
            <BackgroundInsets><AbsInset left="1" right="1" top="1" bottom="1"/></BackgroundInsets>
        </Backdrop>
        <Layers>
            <Layer level="OVERLAY">
                <FontString name="$parentName" inherits="GameFontNormalSmall" text="Enli" justifyH="CENTER">
                    <Anchors><Anchor point="TOP"><Offset><AbsDimension x="0" y="8"/></Offset></Anchor></Anchors>
                </FontString>
            </Layer>
        </Layers>
        <Frames>
            <Button name="$parentEnlighten" inherits="PriestPowerSubButtonTemplate">
                <Anchors>
                    <Anchor point="CENTER"><Offset><AbsDimension x="0" y="0"/></Offset></Anchor>
                </Anchors>
                 <Scripts>
                    <OnLoad>this:RegisterForClicks("LeftButtonUp", "RightButtonUp")</OnLoad>
                    <OnClick>PriestPowerEnlightenButton_OnClick(this)</OnClick>
                    <OnEnter>
                        GameTooltip:SetOwner(this, "ANCHOR_RIGHT")
                        GameTooltip:SetText("Enlighten")
                        GameTooltip:AddLine("Click to Assign Target")
                        GameTooltip:Show()
                    </OnEnter>
                    <OnLeave>GameTooltip:Hide()</OnLeave>
                </Scripts>
            </Button>
        </Frames>
    </Frame>
    
    <Button name="PriestPowerCapabilityIconTemplate" virtual="true">
        <Size><AbsDimension x="18" y="18"/></Size>
        <Layers>
            <Layer level="OVERLAY">
                <Texture name="$parentIcon">
                    <Size><AbsDimension x="16" y="16"/></Size>
                    <Anchors><Anchor point="CENTER"/></Anchors>
                </Texture>
                <FontString name="$parentRank" inherits="GameFontHighlightSmall" text="">
                    <Anchors><Anchor point="BOTTOMRIGHT"><Offset><AbsDimension x="2" y="-2"/></Offset></Anchor></Anchors>
                </FontString>
            </Layer>
        </Layers>
        <Scripts>
            <OnEnter>
                if this.tooltipText then
                    GameTooltip:SetOwner(this, "ANCHOR_RIGHT")
                    GameTooltip:SetText(this.tooltipText)
                    GameTooltip:Show()
                end
            </OnEnter>
            <OnLeave>GameTooltip:Hide()</OnLeave>
        </Scripts>
    </Button>
    
    <Button name="PriestPowerClearButtonTemplate" virtual="true">
        <Size><AbsDimension x="14" y="14"/></Size>
        <NormalTexture file="Interface\Buttons\UI-GroupLoot-Pass-Up"/>
        <PushedTexture file="Interface\Buttons\UI-GroupLoot-Pass-Down"/>
        <HighlightTexture file="Interface\Buttons\UI-GroupLoot-Pass-Highlight" alphaMode="ADD"/>
        <Scripts>
            <OnClick>
                PriestPower_ClearButton_OnClick();
            </OnClick>
            <OnEnter>
                GameTooltip:SetOwner(this, "ANCHOR_RIGHT");
                GameTooltip:SetText("Clear Assignments");
                GameTooltip:AddLine("Requires Leader/Assist", 1,0,0);
            </OnEnter>
            <OnLeave>GameTooltip:Hide();</OnLeave>
        </Scripts>
    </Button>
    
    <Frame name="PriestPowerUserTemplate" hidden="false" virtual="true">
        <Size>
            <AbsDimension x="1000" y="56"/>
        </Size>
        <Layers>
            <Layer level="OVERLAY">
                <FontString name="$parentName" inherits="GameFontHighlightSmall" text="PriestName" justifyH="LEFT">
                    <Size>
                        <AbsDimension x="100" y="16"/>
                    </Size>
                    <Anchors>
                        <Anchor point="TOPLEFT">
                            <Offset><AbsDimension x="25" y="-15"/></Offset>
                        </Anchor>
                    </Anchors>
                </FontString>
                
                <FontString name="$parentChampName" inherits="GameFontHighlightSmall" text="Champion" justifyH="RIGHT">
                     <Size>
                        <AbsDimension x="80" y="16"/>
                    </Size>
                    <Anchors>
                        <Anchor point="TOPLEFT">
                            <Offset><AbsDimension x="740" y="-15"/></Offset>
                        </Anchor>
                    </Anchors>
                </FontString>
                
                <FontString name="$parentEnlightenName" inherits="GameFontHighlightSmall" text="Enlighten" justifyH="RIGHT">
                     <Size>
                        <AbsDimension x="80" y="16"/>
                    </Size>
                    <Anchors>
                        <Anchor point="TOPLEFT">
                            <Offset><AbsDimension x="840" y="-15"/></Offset>
                        </Anchor>
                    </Anchors>
                </FontString>
            </Layer>
        </Layers>
        
        <Frames>
            <!-- Clear Button -->
            <Button name="$parentClear" inherits="PriestPowerClearButtonTemplate">
                <Anchors>
                    <Anchor point="TOPLEFT">
                        <Offset><AbsDimension x="5" y="-14"/></Offset>
                    </Anchor>
                </Anchors>
            </Button>

            <!-- Capability Icons (Learned Spells) -->
            <Frame name="$parentCap" hidden="false">
                <Size><AbsDimension x="140" y="42"/></Size>
                <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="110" y="-12"/></Offset></Anchor></Anchors>
                <Frames>
                    <Button name="$parentFort" inherits="PriestPowerCapabilityIconTemplate"><Anchors><Anchor point="LEFT"/></Anchors></Button>
                    <Button name="$parentSpirit" inherits="PriestPowerCapabilityIconTemplate"><Anchors><Anchor point="LEFT" relativeTo="$parentFort" relativePoint="RIGHT"/></Anchors></Button>
                    <Button name="$parentShadow" inherits="PriestPowerCapabilityIconTemplate"><Anchors><Anchor point="LEFT" relativeTo="$parentSpirit" relativePoint="RIGHT"/></Anchors></Button>
                    <Button name="$parentProclaim" inherits="PriestPowerCapabilityIconTemplate"><Anchors><Anchor point="LEFT" relativeTo="$parentShadow" relativePoint="RIGHT"/></Anchors></Button>
                    <Button name="$parentGrace" inherits="PriestPowerCapabilityIconTemplate"><Anchors><Anchor point="LEFT" relativeTo="$parentProclaim" relativePoint="RIGHT"/></Anchors></Button>
                    <Button name="$parentEmpower" inherits="PriestPowerCapabilityIconTemplate"><Anchors><Anchor point="LEFT" relativeTo="$parentGrace" relativePoint="RIGHT"/></Anchors></Button>
                    <Button name="$parentRevive" inherits="PriestPowerCapabilityIconTemplate"><Anchors><Anchor point="LEFT" relativeTo="$parentEmpower" relativePoint="RIGHT"/></Anchors></Button>
                    <Button name="$parentEnlighten" inherits="PriestPowerCapabilityIconTemplate"><Anchors><Anchor point="LEFT" relativeTo="$parentRevive" relativePoint="RIGHT"/></Anchors></Button>
                </Frames>
            </Frame>
            <!-- 8 Group Buttons (Groups 1-8) -->
            <Frame name="$parentGroup1" inherits="PriestPowerGroupTemplate"><Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="260" y="-5"/></Offset></Anchor></Anchors></Frame>
            <Frame name="$parentGroup2" inherits="PriestPowerGroupTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="$parentGroup1" relativePoint="TOPRIGHT"/></Anchors></Frame>
            <Frame name="$parentGroup3" inherits="PriestPowerGroupTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="$parentGroup2" relativePoint="TOPRIGHT"/></Anchors></Frame>
            <Frame name="$parentGroup4" inherits="PriestPowerGroupTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="$parentGroup3" relativePoint="TOPRIGHT"/></Anchors></Frame>
            <Frame name="$parentGroup5" inherits="PriestPowerGroupTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="$parentGroup4" relativePoint="TOPRIGHT"/></Anchors></Frame>
            <Frame name="$parentGroup6" inherits="PriestPowerGroupTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="$parentGroup5" relativePoint="TOPRIGHT"/></Anchors></Frame>
            <Frame name="$parentGroup7" inherits="PriestPowerGroupTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="$parentGroup6" relativePoint="TOPRIGHT"/></Anchors></Frame>
            <Frame name="$parentGroup8" inherits="PriestPowerGroupTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="$parentGroup7" relativePoint="TOPRIGHT"/></Anchors></Frame>
            
            <!-- Champion Assignment (3 Button Container) -->
            <Frame name="$parentChamp" inherits="PriestPowerChampionTemplate">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="$parentGroup8" relativePoint="TOPRIGHT">
                        <Offset><AbsDimension x="20" y="0"/></Offset>
                    </Anchor>
                </Anchors>
            </Frame>
            
             <!-- Enlighten Assignment (1 Button Container) -->
            <Frame name="$parentEnlighten" inherits="PriestPowerEnlightenTemplate">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="$parentChamp" relativePoint="TOPRIGHT">
                        <Offset><AbsDimension x="5" y="0"/></Offset>
                    </Anchor>
                </Anchors>
            </Frame>
        </Frames>
    </Frame>

    <Frame name="PriestPowerFrame" hidden="true" toplevel="true" frameStrata="MEDIUM" enableMouse="true" movable="true" parent="UIParent">
        <Size>
            <AbsDimension x="1000" y="400"/>
        </Size>
        <Anchors>
            <Anchor point="CENTER"/>
        </Anchors>
        <Backdrop bgFile="Interface\DialogFrame\UI-DialogBox-Background" edgeFile="Interface\DialogFrame\UI-DialogBox-Border" tile="true">
            <EdgeSize>
                <AbsValue val="32"/>
            </EdgeSize>
            <TileSize>
                <AbsValue val="32"/>
            </TileSize>
            <BackgroundInsets>
                <AbsInset left="11" right="12" top="12" bottom="11"/>
            </BackgroundInsets>
        </Backdrop>
        <Frames>
            <!-- Header or Class Icons Row could go here -->
            
            <!-- Rows for Priests (Dynamic? No, let's hardcode 5-8 rows for now or standard raid size) -->
            <!-- PallyPower does this dynamically in Lua loop usually, by instantiating or hiding rows -->
            <!-- We will define 5 rows for now -->
            <Frame name="PriestPowerFramePlayer1" inherits="PriestPowerUserTemplate"><Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="20" y="-30"/></Offset></Anchor></Anchors></Frame>
            <Frame name="PriestPowerFramePlayer2" inherits="PriestPowerUserTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="PriestPowerFramePlayer1" relativePoint="BOTTOMLEFT"/></Anchors></Frame>
            <Frame name="PriestPowerFramePlayer3" inherits="PriestPowerUserTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="PriestPowerFramePlayer2" relativePoint="BOTTOMLEFT"/></Anchors></Frame>
            <Frame name="PriestPowerFramePlayer4" inherits="PriestPowerUserTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="PriestPowerFramePlayer3" relativePoint="BOTTOMLEFT"/></Anchors></Frame>
            <Frame name="PriestPowerFramePlayer5" inherits="PriestPowerUserTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="PriestPowerFramePlayer4" relativePoint="BOTTOMLEFT"/></Anchors></Frame>
            <Frame name="PriestPowerFramePlayer6" inherits="PriestPowerUserTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="PriestPowerFramePlayer5" relativePoint="BOTTOMLEFT"/></Anchors></Frame>
            <Frame name="PriestPowerFramePlayer7" inherits="PriestPowerUserTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="PriestPowerFramePlayer6" relativePoint="BOTTOMLEFT"/></Anchors></Frame>
            <Frame name="PriestPowerFramePlayer8" inherits="PriestPowerUserTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="PriestPowerFramePlayer7" relativePoint="BOTTOMLEFT"/></Anchors></Frame>
            <Frame name="PriestPowerFramePlayer9" inherits="PriestPowerUserTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="PriestPowerFramePlayer8" relativePoint="BOTTOMLEFT"/></Anchors></Frame>
            <Frame name="PriestPowerFramePlayer10" inherits="PriestPowerUserTemplate"><Anchors><Anchor point="TOPLEFT" relativeTo="PriestPowerFramePlayer9" relativePoint="BOTTOMLEFT"/></Anchors></Frame>
            
            <Button name="$parentClose" inherits="UIPanelCloseButton">
                <Anchors>
                    <Anchor point="TOPRIGHT"><Offset><AbsDimension x="-5" y="-5"/></Offset></Anchor>
                </Anchors>
            </Button>
        </Frames>
        <Scripts>
             <OnLoad>
                this:RegisterForDrag("LeftButton");
                PriestPower_OnLoad();
             </OnLoad>
             <OnEvent>
                PriestPower_OnEvent(event);
             </OnEvent>
             <OnDragStart>this:StartMoving()</OnDragStart>
             <OnDragStop>this:StopMovingOrSizing()</OnDragStop>
        </Scripts>
    </Frame>
    
    <Button name="PriestPowerResizeGripTemplate" virtual="true">
        <Size><AbsDimension x="16" y="16"/></Size>
        <Scripts>
            <OnMouseDown>
                PriestPower_ResizeGrip_OnMouseDown()
            </OnMouseDown>
            <OnMouseUp>
                PriestPower_ResizeGrip_OnMouseUp()
            </OnMouseUp>
        </Scripts>
        <NormalTexture file="Interface\AddOns\PriestPower\PriestPower-ResizeGrip.tga"/>
    </Button>

    <!-- HUD Button Template -->
    <Button name="PriestPowerBuffButtonTemplate" virtual="true" hidden="true">
        <Size>
            <AbsDimension x="30" y="30"/>
        </Size>
        <Layers>
            <Layer level="BACKGROUND">
                <Texture name="$parentIcon"/>
            </Layer>
            <Layer level="OVERLAY">
                <FontString name="$parentText" inherits="GameFontHighlightSmall" text="5/5" justifyH="CENTER">
                    <Anchors>
                        <Anchor point="CENTER"><Offset><AbsDimension x="0" y="0"/></Offset></Anchor>
                    </Anchors>
                </FontString>
            </Layer>
        </Layers>
        <Scripts>
            <OnLoad>this:RegisterForClicks("LeftButtonUp", "RightButtonUp")</OnLoad>
            <OnClick>
                -- PriestPower_BuffButton_OnClick(this)
            </OnClick>
            <OnEnter>
                GameTooltip:SetOwner(this, "ANCHOR_RIGHT")
                GameTooltip:SetText(this.tooltipText)
                GameTooltip:Show()
            </OnEnter>
            <OnLeave>GameTooltip:Hide()</OnLeave>
        </Scripts>
        <NormalTexture name="$parentNormalTexture" file="Interface\Buttons\UI-Quickslot2">
			<Size>
				<AbsDimension x="54" y="54"/>
			</Size>
			<Anchors>
				<Anchor point="CENTER">
					<Offset>
						<AbsDimension x="0" y="-1"/>
					</Offset>
				</Anchor>
			</Anchors>
		</NormalTexture>
    </Button>
    <!-- HUD Row Template (Label + Fort + Spirit) -->
    <Frame name="PriestPowerHUDRowTemplate" virtual="true" hidden="true">
        <Size><AbsDimension x="100" y="32"/></Size>
        <Layers>
            <Layer level="OVERLAY">
                <FontString name="$parentLabel" inherits="GameFontNormalSmall" text="Grp X" justifyH="RIGHT">
                    <Anchors><Anchor point="LEFT"><Offset><AbsDimension x="5" y="0"/></Offset></Anchor></Anchors>
                </FontString>
            </Layer>
        </Layers>
        <Frames>
            <Button name="$parentFort" inherits="PriestPowerBuffButtonTemplate">
                <Anchors><Anchor point="LEFT"><Offset><AbsDimension x="40" y="0"/></Offset></Anchor></Anchors>
            </Button>
            <Button name="$parentSpirit" inherits="PriestPowerBuffButtonTemplate">
                <Anchors><Anchor point="LEFT" relativeTo="$parentFort" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
            </Button>
        </Frames>
    </Frame>


    <Frame name="PriestPowerChampDropDown" inherits="UIDropDownMenuTemplate" id="1" hidden="true">
        <Size>
            <AbsDimension x="10" y="10"/>
        </Size>
        <Anchors>
            <Anchor point="CENTER"/>
        </Anchors>
    </Frame>
</Ui>
